# Dodak 유스케이스 명세서

## 문서 정보

| 항목 | 내용 |
|------|------|
| 프로젝트명 | Dodak (AI 기반 감정 일기 & 심리 케어 플랫폼) |
| 문서 버전 | 1.0 |
| 작성일 | 2026-02-03 |

---

## 1. 액터 정의

### 1.1 Primary Actors

| 액터 | 설명 |
|------|------|
| 일반 사용자 (User) | 일기 작성, 감정 분석, 챗봇 상담을 이용하는 사용자 |
| 의사 (Doctor) | 환자 정보 조회 및 상담을 진행하는 전문가 |
| 관리자 (Admin) | 시스템 전체를 관리하는 운영자 |

### 1.2 Secondary Actors

| 액터 | 설명 |
|------|------|
| FastAPI AI Server | 감정 분석 및 챗봇 응답을 제공하는 AI 서버 |
| YouTube | 감정 맞춤형 음악 콘텐츠 제공 |
| MySQL Database | 데이터 저장소 |

---

## 2. 유스케이스 다이어그램

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              Dodak System                                    │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │                         회원 관리                                        ││
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐                   ││
│  │  │   회원가입    │  │    로그인    │  │  정보수정    │                   ││
│  │  └──────────────┘  └──────────────┘  └──────────────┘                   ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│                              │                                               │
│  ┌───────────────────────────┼─────────────────────────────────────────────┐│
│  │                         일기 관리                                        ││
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐                   ││
│  │  │   일기작성    │──│  감정분석    │──│  음악추천    │                   ││
│  │  └──────────────┘  └──────────────┘  └──────────────┘                   ││
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐                   ││
│  │  │   일기조회    │  │   일기수정    │  │   일기삭제   │                   ││
│  │  └──────────────┘  └──────────────┘  └──────────────┘                   ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐│
│  │                         상담 관리                                        ││
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐                   ││
│  │  │  챗봇 상담    │  │   예약신청    │  │  전문상담    │                   ││
│  │  └──────────────┘  └──────────────┘  └──────────────┘                   ││
│  └─────────────────────────────────────────────────────────────────────────┘│
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
         │                              │                              │
         ▼                              ▼                              ▼
    ┌─────────┐                  ┌─────────────┐                 ┌─────────┐
    │  User   │                  │   Doctor    │                 │  Admin  │
    └─────────┘                  └─────────────┘                 └─────────┘
```

---

## 3. 유스케이스 상세

### UC-01: 회원가입

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-01 |
| 유스케이스명 | 회원가입 |
| 액터 | 비회원 |
| 설명 | 신규 사용자가 시스템에 가입한다 |
| 사전조건 | 없음 |
| 사후조건 | 회원 정보가 DB에 저장됨 |

**기본 흐름**
1. 사용자가 회원가입 페이지에 접근한다
2. 시스템이 회원가입 폼을 표시한다
3. 사용자가 필수 정보를 입력한다
   - 아이디, 비밀번호, 이름, 이메일, 전화번호, 주소
4. 사용자가 약관에 동의한다
5. 사용자가 가입 버튼을 클릭한다
6. 시스템이 입력값을 검증한다
7. 시스템이 아이디 중복을 확인한다
8. 시스템이 비밀번호를 암호화한다
9. 시스템이 회원 정보를 저장한다
10. 시스템이 가입 완료 메시지를 표시한다

**대안 흐름**
- 6a. 입력값이 유효하지 않은 경우
  - 6a1. 시스템이 에러 메시지를 표시한다
  - 6a2. 3단계로 돌아간다
- 7a. 아이디가 중복된 경우
  - 7a1. 시스템이 중복 메시지를 표시한다
  - 7a2. 3단계로 돌아간다

---

### UC-02: 로그인

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-02 |
| 유스케이스명 | 로그인 |
| 액터 | 회원 |
| 설명 | 회원이 시스템에 로그인한다 |
| 사전조건 | 회원가입 완료 |
| 사후조건 | 세션이 생성됨 |

**기본 흐름**
1. 사용자가 로그인 페이지에 접근한다
2. 시스템이 로그인 폼을 표시한다
3. 사용자가 아이디와 비밀번호를 입력한다
4. 사용자가 로그인 버튼을 클릭한다
5. 시스템이 인증 정보를 검증한다 (Spring Security)
6. 시스템이 세션을 생성한다
7. 시스템이 권한에 따라 메인 페이지로 이동한다
   - USER → /member/main
   - DOCTOR → /doctor/main

**대안 흐름**
- 5a. 인증 실패
  - 5a1. 시스템이 에러 메시지를 표시한다
  - 5a2. 2단계로 돌아간다

---

### UC-03: 일기 작성

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-03 |
| 유스케이스명 | 일기 작성 |
| 액터 | User |
| 설명 | 사용자가 감정 일기를 작성한다 |
| 사전조건 | 로그인 상태 |
| 사후조건 | 일기 및 감정 분석 결과가 저장됨 |

**기본 흐름**
1. 사용자가 일기 작성 페이지에 접근한다
2. 시스템이 일기 작성 폼을 표시한다
3. 사용자가 제목을 입력한다
4. 사용자가 일기 내용을 입력한다
5. 사용자가 첨부파일을 선택한다 (선택사항)
6. 사용자가 저장 버튼을 클릭한다
7. 시스템이 일기를 DB에 저장한다
8. 시스템이 FastAPI 감정 분석 API를 호출한다
9. AI 서버가 감정 분석 결과를 반환한다
10. 시스템이 분석 결과를 DB에 저장한다
11. 시스템이 감정 분석 결과 화면을 표시한다

**대안 흐름**
- 8a. AI 서버 연결 실패
  - 8a1. 시스템이 일기는 정상 저장한다
  - 8a2. 시스템이 "분석 대기중" 상태로 저장한다
  - 8a3. 백그라운드에서 재시도한다

**확장 (Include)**
- UC-04: 감정 분석

---

### UC-04: 감정 분석

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-04 |
| 유스케이스명 | 감정 분석 |
| 액터 | FastAPI AI Server |
| 설명 | 일기 내용에서 8가지 감정을 분석한다 |
| 사전조건 | 일기 내용이 전달됨 |
| 사후조건 | 감정 비율이 계산됨 |

**기본 흐름**
1. 시스템이 일기 텍스트를 수신한다
2. 시스템이 텍스트를 URL 디코딩한다
3. 시스템이 문장 단위로 분리한다 (Regex 기반)
4. 각 문장에 대해:
   - 4a. 긍정/부정/중립 판별
   - 4b. 8가지 감정 중 하나로 분류
   - 4c. 우울증 키워드 확인
5. 시스템이 감정별 비율을 계산한다
6. 시스템이 우울증 위험도를 계산한다
7. 시스템이 JSON 결과를 반환한다

**응답 형식**
```json
{
  "joy": 25.5,
  "hope": 10.0,
  "neutrality": 15.0,
  "anger": 5.0,
  "sadness": 20.0,
  "anxiety": 10.0,
  "tiredness": 8.5,
  "regret": 6.0,
  "depression": 15.0
}
```

---

### UC-05: 챗봇 상담

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-05 |
| 유스케이스명 | 챗봇 상담 |
| 액터 | User |
| 설명 | AI 챗봇과 대화를 통해 심리 상담을 받는다 |
| 사전조건 | 로그인 상태 |
| 사후조건 | 대화 내역 표시 |

**기본 흐름**
1. 사용자가 챗봇 화면에 접근한다
2. 시스템이 챗봇 인터페이스를 표시한다
3. 사용자가 메시지를 입력한다
4. 사용자가 전송 버튼을 클릭한다
5. 시스템이 FastAPI 챗봇 API를 호출한다
   - Simple (/chatbot/g) 또는 Complex (/chatbot/b)
6. AI 서버가 응답을 생성한다
7. 시스템이 챗봇 응답을 화면에 표시한다
8. 3-7단계를 반복한다

**대안 흐름**
- 6a. 우울 관련 키워드 감지
  - 6a1. 시스템이 전문 상담 연결 안내를 표시한다

---

### UC-06: 음악 추천

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-06 |
| 유스케이스명 | 음악 추천 |
| 액터 | User, YouTube |
| 설명 | 분석된 감정에 맞는 음악을 추천받는다 |
| 사전조건 | 감정 분석 완료 |
| 사후조건 | 추천 음악 목록 표시 |

**기본 흐름**
1. 사용자가 음악 추천 버튼을 클릭한다
2. 시스템이 주요 감정을 식별한다
3. 시스템이 감정에 맞는 검색어를 결정한다
4. 시스템이 FastAPI 음악 검색 API를 호출한다
5. AI 서버가 Selenium으로 YouTube를 크롤링한다
6. AI 서버가 영상 목록을 반환한다
7. 시스템이 추천 영상 목록을 표시한다
8. 사용자가 원하는 영상을 선택한다
9. 시스템이 해당 영상을 재생한다

---

### UC-07: 예약 신청

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-07 |
| 유스케이스명 | 예약 신청 |
| 액터 | User |
| 설명 | 전문 상담 예약을 신청한다 |
| 사전조건 | 로그인 상태 |
| 사후조건 | 예약 정보가 저장됨 (PENDING) |

**기본 흐름**
1. 사용자가 예약 신청 페이지에 접근한다
2. 시스템이 의사 목록을 표시한다
3. 사용자가 상담 의사를 선택한다
4. 시스템이 해당 의사의 가능한 일정을 표시한다
5. 사용자가 희망 날짜와 시간을 선택한다
6. 사용자가 예약 신청 버튼을 클릭한다
7. 시스템이 중복 예약을 확인한다
8. 시스템이 예약 정보를 저장한다 (status: PENDING)
9. 시스템이 예약 완료 메시지를 표시한다

**대안 흐름**
- 7a. 해당 시간에 이미 예약이 있는 경우
  - 7a1. 시스템이 에러 메시지를 표시한다
  - 7a2. 5단계로 돌아간다

---

### UC-08: 예약 확정 (의사)

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-08 |
| 유스케이스명 | 예약 확정 |
| 액터 | Doctor |
| 설명 | 의사가 상담 예약을 확정한다 |
| 사전조건 | PENDING 상태의 예약이 존재 |
| 사후조건 | 예약 상태가 CONFIRMED로 변경됨 |

**기본 흐름**
1. 의사가 예약 관리 페이지에 접근한다
2. 시스템이 대기 중인 예약 목록을 표시한다
3. 의사가 예약을 선택한다
4. 시스템이 예약 상세 정보를 표시한다
5. 의사가 확정 버튼을 클릭한다
6. 시스템이 예약 상태를 CONFIRMED로 변경한다
7. 시스템이 확정 메시지를 표시한다

---

### UC-09: 환자 정보 조회 (의사)

| 항목 | 내용 |
|------|------|
| 유스케이스 ID | UC-09 |
| 유스케이스명 | 환자 정보 조회 |
| 액터 | Doctor |
| 설명 | 의사가 환자의 감정 분석 이력을 조회한다 |
| 사전조건 | DOCTOR 권한으로 로그인 |
| 사후조건 | 환자 정보 표시 |

**기본 흐름**
1. 의사가 환자 목록 페이지에 접근한다
2. 시스템이 예약된 환자 목록을 표시한다
3. 의사가 환자를 선택한다
4. 시스템이 환자의 기본 정보를 표시한다
5. 시스템이 환자의 감정 분석 이력을 표시한다
   - 기간별 감정 변화 추이
   - 우울증 위험도 변화
6. 의사가 상담 메모를 작성한다 (선택)

---

## 4. 유스케이스 관계

### 4.1 Include 관계

| 기본 UC | 포함 UC | 설명 |
|---------|---------|------|
| UC-03 일기 작성 | UC-04 감정 분석 | 일기 저장 시 자동 분석 |

### 4.2 Extend 관계

| 기본 UC | 확장 UC | 조건 |
|---------|---------|------|
| UC-04 감정 분석 | UC-06 음악 추천 | 사용자가 추천 요청 시 |
| UC-05 챗봇 상담 | UC-07 예약 신청 | 전문 상담 필요 시 |

---

## 5. 시나리오

### 5.1 시나리오: 힘든 하루 기록하기

**액터**: 직장인 김민수 (User)

**배경**: 회사에서 스트레스를 많이 받은 김민수가 감정을 정리하기 위해 Dodak을 사용한다.

**흐름**:
1. 김민수가 Dodak에 로그인한다
2. 일기 작성 메뉴를 클릭한다
3. 제목: "너무 힘든 하루"
4. 내용: "오늘 회의에서 상사에게 엄청 혼났다. 내가 뭘 그렇게 잘못했는지 모르겠다. 너무 억울하고 화가 난다. 집에 오는 길에 눈물이 났다."
5. 저장 버튼을 클릭한다
6. 시스템이 감정 분석 결과를 표시한다:
   - 분노: 35%
   - 슬픔: 30%
   - 후회: 15%
   - 불안: 10%
   - 기타: 10%
7. "분노를 달래줄 음악" 추천이 표시된다
8. 김민수가 음악을 들으며 마음을 진정시킨다
9. 챗봇과 대화하며 위로를 받는다

---

### 5.2 시나리오: 우울 감정 감지

**액터**: 대학생 이수진 (User)

**배경**: 최근 우울감을 자주 느끼는 이수진이 일기를 작성한다.

**흐름**:
1. 이수진이 일기를 작성한다
2. 내용: "요즘 아무것도 하기 싫다. 모든 게 의미 없게 느껴진다. 그냥 사라지고 싶다."
3. 시스템이 감정 분석을 수행한다
4. 우울증 위험도: 45% (고위험)
5. 시스템이 경고 메시지를 표시한다:
   - "최근 힘든 시간을 보내고 계신 것 같아요. 전문 상담사와 이야기해 보시는 것은 어떨까요?"
6. 전문 상담 예약 버튼이 강조 표시된다
7. 이수진이 예약 버튼을 클릭한다
8. 상담 예약 프로세스가 진행된다

---

## 6. 관련 문서

| 문서 | 설명 |
|------|------|
| [REQUIREMENTS.md](./REQUIREMENTS.md) | 요구사항 정의서 |
| [FUNCTIONAL_SPECIFICATION.md](./FUNCTIONAL_SPECIFICATION.md) | 기능 명세서 |
| [SCREEN_DESIGN.md](./SCREEN_DESIGN.md) | 화면 설계서 |
| [TEST_CASES.md](./TEST_CASES.md) | 테스트 케이스 |

---

## 7. 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|-----------|--------|
| 1.0 | 2026-02-03 | 최초 작성 | 박제연 |
| 1.1 | 2026-02-09 | 관련 문서 링크 추가, 최신화 | 박제연 |
