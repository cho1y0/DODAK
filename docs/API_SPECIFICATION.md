# Dodak API ëª…ì„¸ì„œ

## ë¬¸ì„œ ì •ë³´

| í•­ëª© | ë‚´ìš© |
|------|------|
| í”„ë¡œì íŠ¸ëª… | Dodak (AI ê¸°ë°˜ ê°ì • ì¼ê¸° & ì‹¬ë¦¬ ì¼€ì–´ í”Œë«í¼) |
| ë¬¸ì„œ ë²„ì „ | 1.2 |
| ì‘ì„±ì¼ | 2026-02-03 |

---

## 1. API ê°œìš”

### 1.1 ì„œë²„ êµ¬ì„±

| ì„œë²„ | URL | ì„¤ëª… |
|------|-----|------|
| Spring Boot | http://192.168.0.x:8083 | ë©”ì¸ ì›¹ ì„œë²„ |
| FastAPI AI | http://192.168.0.20:8000 | AI ë¶„ì„ ì„œë²„ |

### 1.2 ì¸ì¦ ë°©ì‹

- **Spring Boot**: Spring Security ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦
- **FastAPI**: ë³„ë„ ì¸ì¦ ì—†ìŒ (ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼)

---

## 2. FastAPI AI Server API

### 2.1 ì„œë²„ ìƒíƒœ í™•ì¸

```
GET /
```

**ì‘ë‹µ**
```json
{
  "message": "Integrated Server (Diary, Chatbot, Crawler) is running ğŸš€ - FastAPI"
}
```

---

### 2.2 ì¼ê¸° ê°ì • ë¶„ì„

```
GET /diary?s={ì¼ê¸°ë‚´ìš©}
```

**íŒŒë¼ë¯¸í„°**

| ì´ë¦„ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| s | string | O | URL ì¸ì½”ë”©ëœ ì¼ê¸° í…ìŠ¤íŠ¸ |

**ìš”ì²­ ì˜ˆì‹œ**
```
GET /diary?s=%EC%98%A4%EB%8A%98%20%EB%84%88%EB%AC%B4%20%ED%9E%98%EB%93%A4%EC%97%88%EB%8B%A4
```

**ì‘ë‹µ**
```json
{
  "joy": 0.0,
  "hope": 0.0,
  "neutrality": 0.0,
  "anger": 0.0,
  "sadness": 50.0,
  "anxiety": 0.0,
  "tiredness": 50.0,
  "regret": 0.0,
  "depression": 0.0
}
```

**ê°ì • ì„¤ëª…**

| í•„ë“œ | ì„¤ëª… | ë²”ìœ„ |
|------|------|------|
| joy | ê¸°ì¨ ë¹„ìœ¨ | 0.0 ~ 100.0 |
| hope | í¬ë§ ë¹„ìœ¨ | 0.0 ~ 100.0 |
| neutrality | ì¤‘ë¦½ ë¹„ìœ¨ | 0.0 ~ 100.0 |
| anger | ë¶„ë…¸ ë¹„ìœ¨ | 0.0 ~ 100.0 |
| sadness | ìŠ¬í”” ë¹„ìœ¨ | 0.0 ~ 100.0 |
| anxiety | ë¶ˆì•ˆ ë¹„ìœ¨ | 0.0 ~ 100.0 |
| tiredness | í”¼ë¡œ ë¹„ìœ¨ | 0.0 ~ 100.0 |
| regret | í›„íšŒ ë¹„ìœ¨ | 0.0 ~ 100.0 |
| depression | ìš°ìš¸ ë¹„ìœ¨ | 0.0 ~ 100.0 |

**ë¶„ì„ ì•Œê³ ë¦¬ì¦˜**
1. ì…ë ¥ í…ìŠ¤íŠ¸ URL ë””ì½”ë”©
2. Regex ê¸°ë°˜ ë¬¸ì¥ ë¶„ë¦¬
3. ë¬¸ì¥ë³„ ê°ì • í‚¤ì›Œë“œ ë¶„ì„
4. ê¸ì •/ë¶€ì •/ì¤‘ë¦½ 1ì°¨ ë¶„ë¥˜
5. 9ê°€ì§€ ê°ì • ë¶„ë¥˜ (ê¸°ì¨, í¬ë§, ì¤‘ë¦½, ë¶„ë…¸, ìŠ¬í””, ë¶ˆì•ˆ, í”¼ë¡œ, í›„íšŒ, ìš°ìš¸)
6. ë¹„ìœ¨ ê³„ì‚° ë° ë°˜í™˜

---

### 2.3 Simple ì±—ë´‡ (KoGPT2)

```
GET /chatbot/g?s={ë©”ì‹œì§€}
```

**íŒŒë¼ë¯¸í„°**

| ì´ë¦„ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| s | string | X | ì‚¬ìš©ì ì…ë ¥ ë©”ì‹œì§€ |

**ìš”ì²­ ì˜ˆì‹œ**
```
GET /chatbot/g?s=ì•ˆë…•í•˜ì„¸ìš”
```

**ì‘ë‹µ**
```json
{
  "answer": "ì•ˆë…•í•˜ì„¸ìš”. ì €ëŠ” ë‹¹ì‹ ì˜ ì´ì•¼ê¸°ë¥¼ ë“¤ì–´ì¤„ ìˆ˜ ìˆëŠ” ì±—ë´‡ì…ë‹ˆë‹¤."
}
```

**ë¹ˆ ì…ë ¥ ì‹œ ì‘ë‹µ**
```json
{
  "answer": "ë“£ê³  ìˆì–´ìš”. ë” ë§ì”€í•´ì£¼ì„¸ìš”~ (ë„ë•ë„ë•)"
}
```

---

### 2.4 Complex ì±—ë´‡ (KoBERT)

```
GET /chatbot/b?s={ë©”ì‹œì§€}
```

**íŒŒë¼ë¯¸í„°**

| ì´ë¦„ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| s | string | X | ì‚¬ìš©ì ì…ë ¥ ë©”ì‹œì§€ |

**ìš”ì²­ ì˜ˆì‹œ**
```
GET /chatbot/b?s=ìš”ì¦˜ ë„ˆë¬´ ìš°ìš¸í•´ìš”
```

**ì‘ë‹µ**
```json
{
  "answer": "í˜„ì¬ ë§ì´ í˜ë“¤ì–´ ë³´ì´ì„¸ìš”. ì „ë¬¸ ìƒë‹´ì‚¬ì™€ ì—°ê²°í•´ ë“œë¦´ê¹Œìš”?"
}
```

**íŠ¹ìˆ˜ ì‘ë‹µ ì¼€ì´ìŠ¤**

| ê°ì§€ í‚¤ì›Œë“œ | ì‘ë‹µ ìœ í˜• |
|-------------|-----------|
| í™”ê°€, ë¶„ë…¸ | ë¶„ë…¸ ì¡°ì ˆ ê°€ì´ë“œ |
| ìš°ìš¸, ì£½ê³  | ì „ë¬¸ ìƒë‹´ ì—°ê²° ì•ˆë‚´ |
| (ê¸°íƒ€) | ì¼ë°˜ ê³µê° ì‘ë‹µ |

---

### 2.5 YouTube ìŒì•… ê²€ìƒ‰

```
POST /youtube/search
```

**ìš”ì²­ í—¤ë”**
```
Content-Type: application/json
```

**ìš”ì²­ ë³¸ë¬¸**
```json
{
  "keyword": "ìŠ¬í””"
}
```

**ì§€ì› í‚¤ì›Œë“œ**

| í‚¤ì›Œë“œ | ê²€ìƒ‰ ì¿¼ë¦¬ |
|--------|-----------|
| ë¶„ë…¸ | ë¶„ë…¸ ê°€ë¼ì•‰íˆëŠ” ìŒì•… |
| ë¶ˆì•ˆ | ë¶ˆì•ˆí• ë•Œ ë“£ëŠ” ë…¸ë˜ |
| ìŠ¬í”” | ìŠ¬í”Œë•Œ ë“£ëŠ” ë…¸ë˜ |
| ê¸°ì¨ | ê¸°ì ë•Œ ë“£ëŠ” ë…¸ë˜ |
| í›„íšŒ | í›„íšŒí• ë•Œ ë“£ëŠ”ë…¸ë˜ |
| í¬ë§ | í¬ë§ì°¬ ë¸Œê¸ˆ |
| ì¤‘ë¦½ | ë¨¸ë¦¿ì†ì´ ë³µì¡í• ë•Œ ë“£ëŠ” ë…¸ë˜ |
| í”¼ë¡œ | ì§€ì¹˜ê³  í˜ë“¤ë•Œ ë“£ëŠ” ë…¸ë˜ |
| ìš°ìš¸ | ìš°ìš¸í•¨ì„ ë‹¬ë˜ì¤„ ë…¸ë˜ |

**ì‘ë‹µ**
```json
{
  "keyword": "ìŠ¬í””",
  "results": [
    {
      "name": "ìŠ¬í”Œë•Œ ë“£ëŠ” ë…¸ë˜ ëª¨ìŒ",
      "thumnail": "https://i.ytimg.com/vi/xxx/hqdefault.jpg",
      "link": "https://www.youtube.com/watch?v=xxx",
      "viewCount": "100ë§ŒíšŒ",
      "videoDate": "1ë…„ ì „",
      "videoAuthor": "ì±„ë„ëª…",
      "videoAuthorImg": "https://yt3.ggpht.com/xxx",
      "videoDescript": "ì˜ìƒ ì„¤ëª…..."
    }
  ],
  "time": "2026-02-03 14:30:00"
}
```

**ì‘ë‹µ í•„ë“œ**

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| keyword | string | ìš”ì²­ í‚¤ì›Œë“œ |
| results | array | ì˜ìƒ ëª©ë¡ (ìµœëŒ€ 10ê°œ) |
| time | string | ê²€ìƒ‰ ì‹œê° |

**results ë°°ì—´ í•­ëª©**

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| name | string | ì˜ìƒ ì œëª© |
| thumnail | string | ì¸ë„¤ì¼ URL |
| link | string | YouTube ë§í¬ |
| viewCount | string | ì¡°íšŒìˆ˜ |
| videoDate | string | ì—…ë¡œë“œ ì‹œê¸° |
| videoAuthor | string | ì±„ë„ëª… |
| videoAuthorImg | string | ì±„ë„ ì´ë¯¸ì§€ URL |
| videoDescript | string | ì˜ìƒ ì„¤ëª… |

**ì—ëŸ¬ ì‘ë‹µ**
```json
{
  "detail": "ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ"
}
```
HTTP Status: 404

---

## 3. Spring Boot REST API

### 3.1 íšŒì› API

#### 3.1.1 íšŒì› ì •ë³´ ì¡°íšŒ

```
GET /api/member/{id}
```

**ì‘ë‹µ**
```json
{
  "id": 1,
  "userId": "user123",
  "name": "í™ê¸¸ë™",
  "email": "hong@example.com",
  "phone": "010-1234-5678",
  "zipCode": "12345",
  "addr1": "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬",
  "addr2": "í…Œí—¤ë€ë¡œ 123",
  "role": "USER",
  "profileImg": "/uploads/profile/xxx.jpg",
  "joinedAt": "2026-01-15T10:30:00"
}
```

#### 3.1.2 íšŒì› ì •ë³´ ìˆ˜ì •

```
PUT /api/member/{id}
```

**ìš”ì²­**
```json
{
  "password": "newPassword123",
  "name": "í™ê¸¸ë™",
  "phone": "010-9876-5432",
  "zipCode": "54321",
  "addr1": "ì„œìš¸ì‹œ ì„œì´ˆêµ¬",
  "addr2": "ì„œì´ˆëŒ€ë¡œ 456",
  "profileImg": "/uploads/profile/new.jpg"
}
```

---

### 3.2 ì¼ê¸° API

#### 3.2.1 ì¼ê¸° ëª©ë¡ ì¡°íšŒ

```
GET /api/diary?memberId={memberId}
```

**ì‘ë‹µ**
```json
[
  {
    "diaryIdx": 1,
    "diaryTitle": "ì˜¤ëŠ˜ì˜ ì¼ê¸°",
    "diaryContent": "ì˜¤ëŠ˜ì€ ì¢‹ì€ í•˜ë£¨ì˜€ë‹¤...",
    "file1": "/uploads/diary/xxx.jpg",
    "file2": null,
    "file3": null,
    "createdAt": "2026-02-03T10:00:00",
    "analysis": {
      "joyRatio": 50.0,
      "sadnessRatio": 10.0
    }
  }
]
```

#### 3.2.2 ì¼ê¸° ì‘ì„±

```
POST /api/diary
```

**ìš”ì²­ (multipart/form-data)**

| í•„ë“œ | íƒ€ì… | í•„ìˆ˜ | ì„¤ëª… |
|------|------|------|------|
| memberId | int | O | íšŒì› ID |
| diaryTitle | string | O | ì œëª© |
| diaryContent | string | O | ë‚´ìš© |
| file1 | file | X | ì²¨ë¶€íŒŒì¼ 1 |
| file2 | file | X | ì²¨ë¶€íŒŒì¼ 2 |
| file3 | file | X | ì²¨ë¶€íŒŒì¼ 3 |

**ì‘ë‹µ**
```json
{
  "diaryIdx": 10,
  "message": "ì¼ê¸°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

#### 3.2.3 ì¼ê¸° ìˆ˜ì •

```
PUT /api/diary/{diaryIdx}
```

#### 3.2.4 ì¼ê¸° ì‚­ì œ

```
DELETE /api/diary/{diaryIdx}
```

---

### 3.3 ë¶„ì„ API

#### 3.3.1 ë¶„ì„ ê²°ê³¼ ì¡°íšŒ

```
GET /api/analysis?diaryIdx={diaryIdx}
```

**ì‘ë‹µ**
```json
{
  "analysisIdx": 1,
  "diaryIdx": 10,
  "modelName": "skt/kobert-base-v1",
  "anxietyRatio": 10.0,
  "sadnessRatio": 20.0,
  "joyRatio": 25.5,
  "angerRatio": 5.0,
  "regretRatio": 6.0,
  "hopeRatio": 10.0,
  "neutralityRatio": 15.0,
  "tirednessRatio": 8.5,
  "depressionRatio": 15.0,
  "createdAt": "2026-02-03T10:05:00"
}
```

#### 3.3.2 ë¶„ì„ ê²°ê³¼ ì €ì¥

```
POST /api/analysis
```

**ìš”ì²­**
```json
{
  "diaryIdx": 10,
  "modelName": "skt/kobert-base-v1",
  "anxiety": 10.0,
  "sadness": 20.0,
  "joy": 25.5,
  "anger": 5.0,
  "regret": 6.0,
  "hope": 10.0,
  "neutrality": 15.0,
  "tiredness": 8.5,
  "depression": 15.0
}
```

---

### 3.4 ë³‘ì› API

#### 3.4.1 ë³‘ì› ëª©ë¡ ì¡°íšŒ

```
GET /api/hospital
```

#### 3.4.2 ë³‘ì› ë“±ë¡

```
POST /api/hospital
```

**ìš”ì²­**
```json
{
  "hospName": "ë§ˆìŒê±´ê°• ë³‘ì›",
  "zipCode": "12345",
  "addr1": "ì„œìš¸ì‹œ ê°•ë‚¨êµ¬",
  "addr2": "í…Œí—¤ë€ë¡œ 100",
  "tel": "02-1234-5678"
}
```

---

### 3.5 ì˜ì‚¬ API

#### 3.5.1 ì˜ì‚¬ ëª©ë¡ ì¡°íšŒ

```
GET /api/doctor
```

#### 3.5.2 ì˜ì‚¬ ë“±ë¡

```
POST /api/doctor
```

---

### 3.6 ë°°ì • API (í™˜ì-ì˜ì‚¬ ë°°ì •)

#### 3.6.1 ë°°ì • ëª©ë¡ ì¡°íšŒ

```
GET /api/arranges?memberId={memberId}
```

**ì‘ë‹µ**
```json
[
  {
    "arrangeIdx": 1,
    "id": 3,
    "doctIdx": 5,
    "createdAt": "2026-02-03T10:00:00"
  }
]
```

**ì‘ë‹µ í•„ë“œ**

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| arrangeIdx | int | ë°°ì • PK |
| id | int | í™˜ì(íšŒì›) FK |
| doctIdx | int | ì˜ì‚¬ FK |
| createdAt | datetime | ë°°ì • ì¼ì‹œ |

#### 3.6.2 í™˜ì ë°°ì • ë“±ë¡

```
POST /api/arranges
```

**ìš”ì²­**
```json
{
  "id": 3,
  "doctIdx": 5
}
```

**ì‘ë‹µ**
```json
{
  "arrangeIdx": 10,
  "message": "ë°°ì •ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤."
}
```

#### 3.6.3 ë°°ì • ì‚­ì œ

```
DELETE /api/arranges/{arrangeIdx}
```

---

## 4. ì—ëŸ¬ ì½”ë“œ

### 4.1 HTTP ìƒíƒœ ì½”ë“œ

| ì½”ë“œ | ì„¤ëª… |
|------|------|
| 200 | ì„±ê³µ |
| 201 | ìƒì„± ì„±ê³µ |
| 400 | ì˜ëª»ëœ ìš”ì²­ |
| 401 | ì¸ì¦ í•„ìš” |
| 403 | ê¶Œí•œ ì—†ìŒ |
| 404 | ë¦¬ì†ŒìŠ¤ ì—†ìŒ |
| 500 | ì„œë²„ ì˜¤ë¥˜ |

### 4.2 ì—ëŸ¬ ì‘ë‹µ í˜•ì‹

```json
{
  "timestamp": "2026-02-03T10:00:00",
  "status": 400,
  "error": "Bad Request",
  "message": "ìœ íš¨í•˜ì§€ ì•Šì€ ì…ë ¥ê°’ì…ë‹ˆë‹¤.",
  "path": "/api/diary"
}
```

---

## 5. CORS ì„¤ì •

### 5.1 í—ˆìš© Origin

```python
origins = [
    "http://192.168.0.9:8083",
    "http://192.168.0.5:8083",
    "http://192.168.0.1:8083",
    "http://192.168.0.21:8083",
    "http://localhost:8083",
    "http://127.0.0.1:8083",
]
```

### 5.2 í—ˆìš© ì„¤ì •

- ëª¨ë“  HTTP ë©”ì„œë“œ í—ˆìš©
- ëª¨ë“  í—¤ë” í—ˆìš©
- ìê²© ì¦ëª…(ì¿ í‚¤) í—ˆìš©

---

## 6. ê´€ë ¨ ë¬¸ì„œ

| ë¬¸ì„œ | ì„¤ëª… |
|------|------|
| [FUNCTIONAL_SPECIFICATION.md](./FUNCTIONAL_SPECIFICATION.md) | ê¸°ëŠ¥ ëª…ì„¸ì„œ |
| [TECH_STACK.md](./TECH_STACK.md) | ê¸°ìˆ  ìŠ¤íƒ |
| [TEST_CASES.md](./TEST_CASES.md) | í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ |

---

## 7. ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© | ì‘ì„±ì |
|------|------|-----------|--------|
| 1.0 | 2026-02-03 | ìµœì´ˆ ì‘ì„± | ë°•ì œì—° |
| 1.1 | 2026-02-09 | ê´€ë ¨ ë¬¸ì„œ ë§í¬ ì¶”ê°€, ìµœì‹ í™” | ë°•ì œì—° |
| 1.2 | 2026-02-09 | ë°°ì • API ì •ì • (ì˜ˆì•½â†’ë°°ì •), 9ê°€ì§€ ê°ì • ë°˜ì˜ | ë°•ì œì—° |
